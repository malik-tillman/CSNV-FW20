<!doctype html>
<html class="no-js" lang="{{ shop.locale }}">
<head>
	{# Set Metadata #}

	{# Set Metadata: Character set #}
	<meta charset="utf-8">

	{# Set Metadata: Browser stuff | see: https://stackoverflow.com/questions/6771258/what-does-meta-http-equiv-x-ua-compatible-content-ie-edge-do #}
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	{# Set Metadata: Viewport control | see: https://developer.mozilla.org/en-US/docs/Mozilla/Mobile/Viewport_meta_tag #}
	<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">

	{# Set Metadata: Browser theme color | see: https://developers.google.com/web/updates/2014/11/Support-for-theme-color-in-Chrome-39-for-Android #}
	<meta name="theme-color" content="{{ settings.color_button }}">

	{# Set Metadata: Canonical url | see: https://support.google.com/webmasters/answer/139066?hl=en #}
	<link rel="canonical" href="{{ canonical_url }}">

	{% include 'social-meta-tags' %}

	{# Set Metadata: Page description | see: https://moz.com/learn/seo/meta-description #}
	{% if page_description %}
		<meta name="description" content="{{ page_description | escape }}">
	{% endif %}

	{# Set Favicon #}
	{%- if settings.favicon -%}
		<link rel="shortcut icon" href="{{ settings.favicon | img_url: '32x32' }}" type="image/png">
	{%- endif -%}

	{# Generate Title #}
	{%- capture seo_title -%}

		{# Add search heading and results #}
		{%- if request.page_type == 'search' and search.performed == true -%}
			{{ 'general.search.heading' | t: count: search.results_count }}: {{ 'general.search.results_with_count' | t: terms: search.terms, count: search.results_count }}
		{%- else -%}
			{{ page_title }}
		{%- endif -%}

		{# Add tags to title #}
		{%- if current_tags -%}
			{%- assign meta_tags = current_tags | join: ', ' -%} &ndash; {{ 'general.meta.tags' | t: tags: meta_tags -}}
		{%- endif -%}

		{# Add page to title unless on the first page #}
		{%- if current_page != 1 -%}
			&ndash; {{ 'general.meta.page' | t: page: current_page }}
		{%- endif -%}

		{# Add shop name if page title in settings doesn't have it todo:evaluate #}
		{%- assign escaped_page_title = page_title | escape -%}
		{%- unless escaped_page_title contains shop.name -%}
			&ndash; {{ shop.name }}
		{%- endunless -%}

	{%- endcapture -%}

	{# Remove whitespace from start and end of concatnated title #}
	<title>{{ seo_title | strip }}</title>

	{# Preloaded Stylesheets and Scripts #}
	{{ 'csnv.css' | asset_url | stylesheet_tag }}
	{{ '//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js' | script_tag }} {# todo: delete #}
	{{ 'api.jquery.js' | shopify_asset_url | script_tag }} {# todo: delete #}

	{# Deferred Scripts #}
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/shopify-cartjs/0.4.3/cart.min.js" defer></script>
	<script src="{{ 'global.js' | asset_url }}" defer></script>

	{# Blahh #}
	{{ content_for_header }}
</head>

{# todo: Change body page class selector #}
{# todo: optimize classes #}
{# class="template-{{ request.page_type | handle }}" #}
<body class="template--{{ template | split: '/' | join : '-' | split: '.' | join: '-'}}">

	{# ------ Background Video on Index ------ #}
	{% if template == 'index' %}
		{%- if settings.home_video_url_webm and settings.home_video_mp4 -%}
			<div class="video-container">
				<video autoplay muted loop playsinline preload poster="
						{%- if settings.home_video_thumbnail -%}
							{{ settings.home_video_thumbnail | img_url: 'large' }}
						{%- endif -%}">
					<source src="{{ settings.home_video_url_webm }}" type="video/webm">
					<source src="{{ settings.home_video_url_mp4 }}" type="video/mp4">
				</video>
			</div>
		{%- endif -%}
	{% endif %}

    {# ------ Marquee Text ------ #}
    {# todo: Change classes to `marquee-[level-name]` #}
	{%- if settings.marquee_text -%}
		<div class="alert-banner">
			<div class="alert-banner__marquee">
				<span>{{ settings.marquee_text }}</span>
				<span>{{ settings.marquee_text }}</span>
				<span>{{ settings.marquee_text }}</span>
			</div>
		</div>
	{%- endif -%}

	{# ------ Cart ------ #}
	<div class="header-cart">
		{# Show Count #}
		{% if cart.item_count > 0 %}
			<div class="header-cart__count">
				<span class="header-cart__count__text" aria-label="Amount of items in cart">[{{ cart.item_count }}]</span>
			</div>
		{% endif %}

		{# Cart Icon #}
		{# todo: Change button to link #}
		<button class="header-cart__button" type="button">
			<span class="visually-hidden">Shopping Cart</span>
			{% include "CSNV-Icons/icon-bag" %}
		</button>
	</div>

	{# ------ Side Nav ------ #}
	<aside class="side-bar">
		{# Logo and Rights #}
		<div class="side-bar__header-logo">
			{# Logo Link #}
			{# todo: Localize title #}
			<a href="/" title="CSNV Home">
				<img src="{{ 'logo.gif' | asset_url }}" alt="CSNV Logo"/>
			</a>

			{# All Rights Reserved #}
			{# todo: Localize #}
			<small class="side-bar__header-logo__reg">All Rights Reserved <br>
			&copy; 2019 CSNV studio</small>
		</div>

		{# Nav #}
		<nav class="side-bar__nav">
			{# Mobile Menu Button #}
			<button class="side-bar__menu-button"><span>Menu</span></button>

			{# Nav Link List #}
			<ul>
				{% for link in linklists.main-menu.links %}
					{# Retrieve Index Link Handle #}
					{% assign child_list_handle = link.title | handleize %}

					{# Dropdown Link on Non-blank Link List #}
					{% if linklists[child_list_handle].links != blank %}
						<li class="side-bar__nav__dropdown">

							{# Link #}
							{# todo: Localize #}
							<button class="side-bar__nav__dropdown-trigger" type="button">
								{{ link.title }}
							</button>

							{# Dropdown Menu for Link #}
							<ul class="side-bar__nav__dropdown-container" aria-expanded="false">
								{% for childLink in linklists[child_list_handle].links %}
									<li>
										{# todo: Localize #}
										<a href="{{ childLink.url }}" title="{{ childLink.title | escape }}">
											{{ childLink.title | escape}}
										</a>
									</li>
								{% endfor %}
							</ul>
						</li>

					{# Regular Link on Blank Link List #}
					{% else %}
						{# todo: Localize #}
						<li><a href="{{ link.url }}" title="{{ link.title | escape }}">{{ link.title | escape}}</a></li>

					{% endif %}
				{% endfor %}

				{# Customer Account #}
				{% if shop.customer_accounts_enabled %}

					{# Add Account and Log Out Link #}
					{% if customer %}
						{# todo: Localize #}
						<li><a href="/account" title="Go to your account">
							Account <br /><span class="account-name">({{ customer.email }})</span></a></li>
						<li><a href="/account/logout" title="Log out">Log out</a></li>

					{# Add Login and Register Link #}
					{% else %}
						{# todo: Localize #}
						<li><a href="/account/login" title="Log in to your account">Log in</a></li>
						<li><a href="/account/register" title="Register for an accountt">Register</a></li>

					{% endif %}
				{% endif %}
			</ul>

			{# Search Icon and Bar #}
			<div class="side-bar__search" tabindex="0">
				<form class="side-bar__search-form" action="{{ routes.search_url }}">
					{# Label #}
					{# todo: Localize #}
					<label for="q" class="visually-hidden">Search</label>

					{# Input #}
					{# todo: optimize ID and Name #}
					<div class="side-bar__search-mask">
						<input type="text" placeholder="Search..." id="q" name="q">
					</div>

					{# Search Button #}
					<button class="side-bar__search-button">
						{% include "CSNV-Icons/icon-search" %}
						<span class="visually-hidden">Search</span>
					</button>
				</form>
			</div>
		</nav>

		{# Footer #}
		<footer class="side-bar__footer">
			<div class="side-bar__social">
				<ul> {# todo: Localize #}
					{# Facebook Link #}
					{% if settings.facebook_link %}
					<li>
						<a href="{{ settings.facebook_link }}" class="side-bar__social__link side-bar__social--facebook" target="_blank">
							{% include "CSNV-Icons/icon-facebook" %}
							<span class="visually-hidden">Facebook</span>
						</a>
					</li>
					{% endif %}

					{# Instagram Link #}
					{% if settings.instagram_link %}
					<li>
						<a href="{{ settings.instagram_link }}" class="side-bar__social__link side-bar__social--instagram" target="_blank">
							{% include "CSNV-Icons/icon-instagram" %}
							<span class="visually-hidden">Instagram</span>
						</a>
					</li>
					{% endif %}

					{# Twitter Link #}
					{% if settings.twitter_link %}
					<li>
						<a href="{{ settings.twitter_link }}" class="side-bar__social__link side-bar__social--twitter" target="_blank">
							{% include "CSNV-Icons/icon-twitter" %}
							<span class="visually-hidden">Twitter</span>
						</a></li>
					{% endif %}

					{# TikTok Link #}
					{% if settings.tiktok_link %}
					<li>
						<a href="{{ settings.tiktok_link }}" class="side-bar__social__link side-bar__social--tiktok" target="_blank">
							{% include "CSNV-Icons/icon-twitter" %}
							<span class="visually-hidden">Tik Tok</span>
						</a>
					</li>
					{% endif %}
				</ul>
			</div>
		</footer>

		{# todo: evaluate | delete #}
		<div class="side-bar__mask"></div>
	</aside>

	{# ------ Main Content Container ------ #}
	<div class="container">
		<main>
			{# Ignores Content for Index #}
			{# todo: evaluate #}
			{% if template != 'index' %}
				{{ content_for_layout }}
			{% endif %}
		</main>
	</div>

	{# ------ Shopping Cart Menu ------ #}
	<div class="shopping-cart">
		{# todo: evaluate | delete #}
		<div class="shopping-cart__mask"></div>

		{# Cart #}
		<div class="shopping-cart__content">
			{# Close Button #}
			<button class="shopping-cart__close" aria-labeled="Close shopping cart">
				{% include "CSNV-Icons/icon-close" %}

				{# todo: localize #}
				<span class="visually-hidden">Close</span>
			</button>

			{# todo: localize #}
			<span class="visually-hidden">Close</span>

			{# No Items in Cart #}
			{% if cart.item_count == 0 %}
				<div class="shopping-cart__empty-text">The shopping cart is empty</div>

			{# Items are in Cart #}
			{% else %}
				<form action="{{ routes.cart_url }}" method="post" novalidate class="cart">

					{# Items in Cart #}
					<div class="shopping-cart__items">

						{# Cart Title #}
						{# todo: localize #}
						<h1 id="cart-title" >Your cart</h1>

						{# Loop Through Cart Items #}
						{%- for item in cart.items -%}

							{# Display Each Item's Information #}
							<div class="shopping-cart__item">

								{# Item Image #}
								<img class="shopping-cart__image" src="{{ item.image | img_url: '400x400' }}" alt="{{ item.product.title }}">

								{# Item Details #}
								<div class="shopping-cart__details">

									{# Item Title #}
									<span class="shopping-cart__title">
										{# Link to Item #}
										<a href="{{ item.url }}" title="{{ item.product.title }}">
											{{ item.product.title }}
										</a>
									</span>

									{# Item Price #}
									<span class="shopping-cart__price">{{ item.product.price | money}}</span>

									{# Quantity Selection #}
									<span class="shopping-cart__quantity">

										{# Item Input Label #}
										<label for="updates_{{ item.key }}" class="visually-hidden">
											Quantity:
										</label>

										{# Minus Item Input #}
										<button type="button" class="shopping-cart__quantity-button shopping-cart__quantity-button--minus" data-quantity-input="{{ item.key }}">
											<span>−</span>
										</button>

										{# Input Number Amount #}
										<input id="updates_{{ item.key }}_cart" class="shopping-cart__quantity-input"
											   name="updates[]" type="text" value="{{ item.quantity }}"
											   data-min="0" data-max="{{ item.quantity }}" pattern="[0-9]*"
											   data-quantity-input="{{ item.key }}"
											   data-quantity-item="{{ forloop.index }}" data-quantity-input-mobile>

										{# Add Item Input #}
										<button type="button" class="shopping-cart__quantity-button shopping-cart__quantity-button--plus" data-quantity-input="{{ item.key }}">
											<span>+</span>
										</button>

									</span>

									{# Remove Product #}
									<p class="shopping-cart__cart-remove">
										<a href="/cart/change?line={{ forloop.index }}&amp;quantity=0"
										   class="text-link text-link--accent" aria-label="Remove">
											Remove
										</a>
									</p>

								</div>

							</div>

						{%- endfor -%}

					</div>

					{# Cart Subtotal #}
					<div class="shopping-cart__subtotal">
						<span class="shopping-cart__subtotal-text">
							{# todo: Localize #}
							<span>Subtotal</span>{{ cart.total_price | money }}
						</span>
					</div>

					{# Cart Footer #}
					<div class="shopping-cart__footer">
						{# todo: Localize #}
						<p>Shipping & taxes calculated at checkout</p>

						{# todo: Localize #}
						<p><strong>INTERNATIONAL ORDERS MAY BE SUBJECT TO CUSTOMS DUTIES OR IMPORT TAXES</strong></p>
					</div>

					{# Submit Button #}
					<div class="shopping-cart__button-containers">
						<!-- <a class="shopping-cart__empty-cart" href="/cart/clear">Empty Cart</a> -->

						{# todo: Localize #}
						<button class="shopping-cart__checkout button--colored" name="checkout" action="/checkout/">
							Checkout
						</button>
					</div>

				</form>

			{% endif %}
		</div>
	</div>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/shopify-cartjs/0.4.3/cart.min.js" ></script>
	<script src="{{ 'global.js' | asset_url }}" ></script>
</body>
</html>
